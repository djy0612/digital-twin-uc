09:53:21.354 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.logging.InternalLoggerFactory - Using SLF4J as the default logging framework
09:53:21.362 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0 - -Dio.netty.noUnsafe: false
09:53:21.363 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0 - Java version: 17
09:53:21.364 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0 - sun.misc.Unsafe.theUnsafe: available
09:53:21.364 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0 - sun.misc.Unsafe.copyMemory: available
09:53:21.365 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0 - java.nio.Buffer.address: available
09:53:21.367 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0 - direct buffer constructor: unavailable
java.lang.UnsupportedOperationException: Reflective setAccessible(true) disabled
	at io.grpc.netty.shaded.io.netty.util.internal.ReflectionUtil.trySetAccessible(ReflectionUtil.java:31)
	at io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0$4.run(PlatformDependent0.java:225)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:318)
	at io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0.<clinit>(PlatformDependent0.java:219)
	at io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent.isAndroid(PlatformDependent.java:289)
	at io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent.<clinit>(PlatformDependent.java:92)
	at io.grpc.netty.shaded.io.netty.util.AsciiString.<init>(AsciiString.java:223)
	at io.grpc.netty.shaded.io.netty.util.AsciiString.<init>(AsciiString.java:210)
	at io.grpc.netty.shaded.io.netty.util.AsciiString.cached(AsciiString.java:1401)
	at io.grpc.netty.shaded.io.netty.util.AsciiString.<clinit>(AsciiString.java:48)
	at io.grpc.netty.shaded.io.grpc.netty.Utils.<clinit>(Utils.java:73)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerBuilder.<clinit>(NettyServerBuilder.java:78)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerProvider.builderForPort(NettyServerProvider.java:39)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerProvider.builderForPort(NettyServerProvider.java:24)
	at io.grpc.ServerBuilder.forPort(ServerBuilder.java:41)
	at org.example.policy.service.PolicyServer.<init>(PolicyServer.java:16)
	at org.example.policy.service.PolicyServer.main(PolicyServer.java:67)
09:53:21.367 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0 - java.nio.Bits.unaligned: available, true
09:53:21.368 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0 - jdk.internal.misc.Unsafe.allocateUninitializedArray(int): unavailable
java.lang.IllegalAccessException: class io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0$6 cannot access class jdk.internal.misc.Unsafe (in module java.base) because module java.base does not export jdk.internal.misc to unnamed module @26ee6b5e
	at java.base/jdk.internal.reflect.Reflection.newIllegalAccessException(Reflection.java:392)
	at java.base/java.lang.reflect.AccessibleObject.checkAccess(AccessibleObject.java:674)
	at java.base/java.lang.reflect.Method.invoke(Method.java:561)
	at io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0$6.run(PlatformDependent0.java:335)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:318)
	at io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0.<clinit>(PlatformDependent0.java:326)
	at io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent.isAndroid(PlatformDependent.java:289)
	at io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent.<clinit>(PlatformDependent.java:92)
	at io.grpc.netty.shaded.io.netty.util.AsciiString.<init>(AsciiString.java:223)
	at io.grpc.netty.shaded.io.netty.util.AsciiString.<init>(AsciiString.java:210)
	at io.grpc.netty.shaded.io.netty.util.AsciiString.cached(AsciiString.java:1401)
	at io.grpc.netty.shaded.io.netty.util.AsciiString.<clinit>(AsciiString.java:48)
	at io.grpc.netty.shaded.io.grpc.netty.Utils.<clinit>(Utils.java:73)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerBuilder.<clinit>(NettyServerBuilder.java:78)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerProvider.builderForPort(NettyServerProvider.java:39)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerProvider.builderForPort(NettyServerProvider.java:24)
	at io.grpc.ServerBuilder.forPort(ServerBuilder.java:41)
	at org.example.policy.service.PolicyServer.<init>(PolicyServer.java:16)
	at org.example.policy.service.PolicyServer.main(PolicyServer.java:67)
09:53:21.368 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0 - java.nio.DirectByteBuffer.<init>(long, int): unavailable
09:53:21.369 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent - sun.misc.Unsafe: available
09:53:21.381 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent - maxDirectMemory: 536870912 bytes (maybe)
09:53:21.381 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent - -Dio.netty.tmpdir: /tmp (java.io.tmpdir)
09:53:21.382 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent - -Dio.netty.bitMode: 64 (sun.arch.data.model)
09:53:21.382 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent - -Dio.netty.maxDirectMemory: -1 bytes
09:53:21.382 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent - -Dio.netty.uninitializedArrayAllocationThreshold: -1
09:53:21.383 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.CleanerJava9 - java.nio.ByteBuffer.cleaner(): available
09:53:21.383 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent - -Dio.netty.noPreferDirect: false
09:53:21.386 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader - -Dio.netty.native.workdir: /tmp (io.netty.tmpdir)
09:53:21.387 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader - -Dio.netty.native.deleteLibAfterLoading: true
09:53:21.387 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader - -Dio.netty.native.tryPatchShadedId: true
09:53:21.387 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader - Unable to load the library 'io_grpc_netty_shaded_netty_transport_native_epoll_x86_64', trying other loading mechanism.
java.lang.UnsatisfiedLinkError: no io_grpc_netty_shaded_netty_transport_native_epoll_x86_64 in java.library.path: /usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
	at java.base/java.lang.ClassLoader.loadLibrary(ClassLoader.java:2434)
	at java.base/java.lang.Runtime.loadLibrary0(Runtime.java:818)
	at java.base/java.lang.System.loadLibrary(System.java:1993)
	at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryUtil.loadLibrary(NativeLibraryUtil.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader$1.run(NativeLibraryLoader.java:371)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:318)
	at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader.loadLibraryByHelper(NativeLibraryLoader.java:363)
	at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader.loadLibrary(NativeLibraryLoader.java:341)
	at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader.load(NativeLibraryLoader.java:136)
	at io.grpc.netty.shaded.io.netty.channel.epoll.Native.loadNativeLibrary(Native.java:231)
	at io.grpc.netty.shaded.io.netty.channel.epoll.Native.<clinit>(Native.java:58)
	at io.grpc.netty.shaded.io.netty.channel.epoll.Epoll.<clinit>(Epoll.java:39)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:375)
	at io.grpc.netty.shaded.io.grpc.netty.Utils.isEpollAvailable(Utils.java:288)
	at io.grpc.netty.shaded.io.grpc.netty.Utils.<clinit>(Utils.java:108)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerBuilder.<clinit>(NettyServerBuilder.java:78)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerProvider.builderForPort(NettyServerProvider.java:39)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerProvider.builderForPort(NettyServerProvider.java:24)
	at io.grpc.ServerBuilder.forPort(ServerBuilder.java:41)
	at org.example.policy.service.PolicyServer.<init>(PolicyServer.java:16)
	at org.example.policy.service.PolicyServer.main(PolicyServer.java:67)
09:53:21.388 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader - io_grpc_netty_shaded_netty_transport_native_epoll_x86_64 cannot be loaded from java.library.path, now trying export to -Dio.netty.native.workdir: /tmp
java.lang.UnsatisfiedLinkError: no io_grpc_netty_shaded_netty_transport_native_epoll_x86_64 in java.library.path: /usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
	at java.base/java.lang.ClassLoader.loadLibrary(ClassLoader.java:2434)
	at java.base/java.lang.Runtime.loadLibrary0(Runtime.java:818)
	at java.base/java.lang.System.loadLibrary(System.java:1993)
	at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryUtil.loadLibrary(NativeLibraryUtil.java:38)
	at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader.loadLibrary(NativeLibraryLoader.java:351)
	at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader.load(NativeLibraryLoader.java:136)
	at io.grpc.netty.shaded.io.netty.channel.epoll.Native.loadNativeLibrary(Native.java:231)
	at io.grpc.netty.shaded.io.netty.channel.epoll.Native.<clinit>(Native.java:58)
	at io.grpc.netty.shaded.io.netty.channel.epoll.Epoll.<clinit>(Epoll.java:39)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:375)
	at io.grpc.netty.shaded.io.grpc.netty.Utils.isEpollAvailable(Utils.java:288)
	at io.grpc.netty.shaded.io.grpc.netty.Utils.<clinit>(Utils.java:108)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerBuilder.<clinit>(NettyServerBuilder.java:78)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerProvider.builderForPort(NettyServerProvider.java:39)
	at io.grpc.netty.shaded.io.grpc.netty.NettyServerProvider.builderForPort(NettyServerProvider.java:24)
	at io.grpc.ServerBuilder.forPort(ServerBuilder.java:41)
	at org.example.policy.service.PolicyServer.<init>(PolicyServer.java:16)
	at org.example.policy.service.PolicyServer.main(PolicyServer.java:67)
	Suppressed: java.lang.UnsatisfiedLinkError: no io_grpc_netty_shaded_netty_transport_native_epoll_x86_64 in java.library.path: /usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
		at java.base/java.lang.ClassLoader.loadLibrary(ClassLoader.java:2434)
		at java.base/java.lang.Runtime.loadLibrary0(Runtime.java:818)
		at java.base/java.lang.System.loadLibrary(System.java:1993)
		at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryUtil.loadLibrary(NativeLibraryUtil.java:38)
		at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
		at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
		at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.base/java.lang.reflect.Method.invoke(Method.java:569)
		at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader$1.run(NativeLibraryLoader.java:371)
		at java.base/java.security.AccessController.doPrivileged(AccessController.java:318)
		at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader.loadLibraryByHelper(NativeLibraryLoader.java:363)
		at io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader.loadLibrary(NativeLibraryLoader.java:341)
		... 14 common frames omitted
09:53:21.413 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.NativeLibraryLoader - Successfully loaded the library /tmp/libio_grpc_netty_shaded_netty_transport_native_epoll_x86_648635717991653154280.so
09:53:21.414 [main] DEBUG io.grpc.netty.shaded.io.netty.util.NetUtil - -Djava.net.preferIPv4Stack: false
09:53:21.414 [main] DEBUG io.grpc.netty.shaded.io.netty.util.NetUtil - -Djava.net.preferIPv6Addresses: false
09:53:21.415 [main] DEBUG io.grpc.netty.shaded.io.netty.util.NetUtil - Loopback interface: lo (lo, 0:0:0:0:0:0:0:1%lo)
09:53:21.416 [main] DEBUG io.grpc.netty.shaded.io.netty.util.NetUtil - /proc/sys/net/core/somaxconn: 4096
09:53:21.430 [main] DEBUG io.grpc.netty.shaded.io.netty.channel.MultithreadEventLoopGroup - -Dio.netty.eventLoopThreads: 4
[org.wso2.balana.attr.StandardAttributeFactory] : Initializing standard datatypes
[org.wso2.balana.cond.StandardFunctionFactory] : Initializing standard Target functions
[org.wso2.balana.cond.StandardFunctionFactory] : Initializing standard Condition functions
[org.wso2.balana.cond.StandardFunctionFactory] : Initializing standard General functions
[org.wso2.balana.combine.StandardCombiningAlgFactory] : Initializing standard combining algorithms
[org.wso2.balana.PDP] : creating a PDP
[org.wso2.balana.finder.PolicyFinder] : Initializing PolicyFinder
09:53:21.543 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.InternalThreadLocalMap - -Dio.netty.threadLocalMap.stringBuilder.initialSize: 1024
09:53:21.543 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.InternalThreadLocalMap - -Dio.netty.threadLocalMap.stringBuilder.maxSize: 4096
09:53:21.548 [main] DEBUG io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent - org.jctools-core.MpscChunkedArrayQueue: available
09:53:21.560 [main] DEBUG io.grpc.netty.shaded.io.netty.util.ResourceLeakDetector - -Dio.grpc.netty.shaded.io.netty.leakDetection.level: simple
09:53:21.561 [main] DEBUG io.grpc.netty.shaded.io.netty.util.ResourceLeakDetector - -Dio.grpc.netty.shaded.io.netty.leakDetection.targetRecords: 4
09:53:21.562 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.numHeapArenas: 4
09:53:21.562 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.numDirectArenas: 4
09:53:21.562 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.pageSize: 8192
09:53:21.563 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.maxOrder: 11
09:53:21.563 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.chunkSize: 16777216
09:53:21.563 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.tinyCacheSize: 512
09:53:21.563 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.smallCacheSize: 256
09:53:21.563 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.normalCacheSize: 64
09:53:21.563 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.maxCachedBufferCapacity: 32768
09:53:21.563 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.cacheTrimInterval: 8192
09:53:21.563 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.cacheTrimIntervalMillis: 0
09:53:21.563 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.useCacheForAllThreads: true
09:53:21.564 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.PooledByteBufAllocator - -Dio.netty.allocator.maxCachedByteBuffersPerChunk: 1023
09:53:21.577 [main] DEBUG io.grpc.netty.shaded.io.netty.channel.DefaultChannelId - -Dio.netty.processId: 661505 (auto-detected)
09:53:21.578 [main] DEBUG io.grpc.netty.shaded.io.netty.channel.DefaultChannelId - -Dio.netty.machineId: 00:0c:29:ff:fe:82:58:e4 (auto-detected)
09:53:21.588 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.ByteBufUtil - -Dio.netty.allocator.type: pooled
09:53:21.589 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.ByteBufUtil - -Dio.netty.threadLocalDirectBufferSize: 0
09:53:21.589 [main] DEBUG io.grpc.netty.shaded.io.netty.buffer.ByteBufUtil - -Dio.netty.maxThreadLocalCharBufferSize: 16384
09:53:21.614 [main] INFO org.example.policy.service.PolicyServer - Policy Server started on port 9090
09:53:21.615 [main] INFO org.example.policy.service.PolicyServer - Policy Server is running...
09:53:32.159 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.netty.buffer.AbstractByteBuf - -Dio.grpc.netty.shaded.io.netty.buffer.checkAccessible: true
09:53:32.160 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.netty.buffer.AbstractByteBuf - -Dio.grpc.netty.shaded.io.netty.buffer.checkBounds: true
09:53:32.161 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.netty.util.ResourceLeakDetectorFactory - Loaded default ResourceLeakDetector: io.grpc.netty.shaded.io.netty.util.ResourceLeakDetector@d08b7d4
09:53:32.206 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
09:53:32.209 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.netty.util.Recycler - -Dio.netty.recycler.maxCapacityPerThread: 4096
09:53:32.209 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.netty.util.Recycler - -Dio.netty.recycler.maxSharedCapacityFactor: 2
09:53:32.209 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.netty.util.Recycler - -Dio.netty.recycler.linkCapacity: 16
09:53:32.210 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.netty.util.Recycler - -Dio.netty.recycler.ratio: 8
09:53:32.216 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
09:53:32.237 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND SETTINGS: ack=false settings=[id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430]
09:53:32.246 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND SETTINGS: ack=true
09:53:32.251 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND SETTINGS: ack=true
09:53:32.260 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:32.275 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:53:32.275 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND PING: ack=false bytes=1234
09:53:32.278 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND PING: ack=true bytes=1234
09:53:32.282 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
09:53:32.285 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND RST_STREAM: streamId=1 errorCode=0
09:53:32.287 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:32.292 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:53:32.292 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND PING: ack=false bytes=1234
09:53:32.293 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND PING: ack=true bytes=1234
09:53:32.411 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:32.422 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
09:53:32.430 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
09:53:32.431 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND PING: ack=false bytes=145258749040133895
09:53:32.431 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND PING: ack=true bytes=145258749040133895
09:53:32.435 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:32.438 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND DATA: streamId=5 padding=0 endStream=true length=603 bytes=00000002560ad3043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:53:32.439 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND PING: ack=false bytes=1234
09:53:32.444 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND PING: ack=true bytes=1234
09:53:32.445 [pool-1-thread-5] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 595
09:53:32.489 [pool-1-thread-5] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:53:32.525 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
09:53:32.528 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
09:53:32.530 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
09:53:32.531 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND SETTINGS: ack=false settings=[id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454]
09:53:32.531 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND SETTINGS: ack=true
09:53:32.532 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND SETTINGS: ack=true
09:53:32.532 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:53:32.526 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
09:53:32.534 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND SETTINGS: ack=false settings=[id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446]
09:53:32.534 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND SETTINGS: ack=true
09:53:32.536 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=1 padding=0 endStream=true length=603 bytes=000000025612d3043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:53:32.536 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
09:53:32.536 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
09:53:32.536 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND SETTINGS: ack=true
09:53:32.537 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:53:32.539 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=1 padding=0 endStream=true length=603 bytes=000000025612d3043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:53:32.539 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
09:53:32.539 [pool-1-thread-6] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:53:32.539 [pool-1-thread-6] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string"/></Apply></Condition></Rule></Policy>
09:53:32.540 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
09:53:32.543 [pool-1-thread-8] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:53:32.543 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:32.545 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=1 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:53:32.543 [pool-1-thread-8] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string"/></Apply></Condition></Rule></Policy>
09:53:32.546 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:53:32.546 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
09:53:32.546 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
09:53:32.547 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:32.551 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:32.554 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=1 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:53:32.555 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:53:32.555 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
09:53:32.555 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
09:53:32.555 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:34.737 [pool-1-thread-5] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=500, message=null
09:53:34.738 [pool-1-thread-5] ERROR org.example.policy.engine.DigitalTwinPolicyEngine - Upload failed with error response: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:53:32.50625152Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:53:32.50625152Z' could not be parsed at index 20 at [Source: (String)"[{"id":"024f20b6-f2f6-471b-b754-4d4ab2cd3c87","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeValue DataType=\"http://www.w3.org/2"[truncated 664 chars]; line: 1, column: 865] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
09:53:34.738 [pool-1-thread-5] ERROR org.example.policy.engine.DigitalTwinPolicyEngine - Failed to upload policy to Fabric-Client: Upload failed with status 500: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:53:32.50625152Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:53:32.50625152Z' could not be parsed at index 20 at [Source: (String)"[{"id":"024f20b6-f2f6-471b-b754-4d4ab2cd3c87","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeValue DataType=\"http://www.w3.org/2"[truncated 664 chars]; line: 1, column: 865] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
java.lang.RuntimeException: Upload failed with status 500: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:53:32.50625152Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:53:32.50625152Z' could not be parsed at index 20 at [Source: (String)"[{"id":"024f20b6-f2f6-471b-b754-4d4ab2cd3c87","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeValue DataType=\"http://www.w3.org/2"[truncated 664 chars]; line: 1, column: 865] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
	at org.example.policy.engine.DigitalTwinPolicyEngine.uploadPolicy(DigitalTwinPolicyEngine.java:218)
	at org.example.policy.service.PolicyServiceImpl.uploadPolicy(PolicyServiceImpl.java:94)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:436)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
09:53:34.739 [pool-1-thread-5] ERROR org.example.policy.service.PolicyServiceImpl - Error uploading policy
java.lang.RuntimeException: Failed to upload policy to Fabric-Client
	at org.example.policy.engine.DigitalTwinPolicyEngine.uploadPolicy(DigitalTwinPolicyEngine.java:231)
	at org.example.policy.service.PolicyServiceImpl.uploadPolicy(PolicyServiceImpl.java:94)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:436)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.RuntimeException: Upload failed with status 500: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:53:32.50625152Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:53:32.50625152Z' could not be parsed at index 20 at [Source: (String)"[{"id":"024f20b6-f2f6-471b-b754-4d4ab2cd3c87","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeValue DataType=\"http://www.w3.org/2"[truncated 664 chars]; line: 1, column: 865] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
	at org.example.policy.engine.DigitalTwinPolicyEngine.uploadPolicy(DigitalTwinPolicyEngine.java:218)
	... 10 common frames omitted
09:53:34.744 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:34.746 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=54 bytes=0000000031122f4572726f723a204661696c656420746f2075706c6f616420706f6c69637920746f204661627269632d436c69656e74
09:53:34.746 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=54
09:53:34.746 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND PING: ack=false bytes=145258749040133895
09:53:34.746 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND PING: ack=true bytes=145258749040133895
09:53:34.747 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:34.748 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
09:53:34.748 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND PING: ack=false bytes=1234
09:53:34.757 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] INBOUND PING: ack=true bytes=1234
09:53:34.758 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcfc0592e, L:/127.0.0.1:9090 - R:/127.0.0.1:46430] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:46.654 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
09:53:46.655 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
09:53:46.655 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND SETTINGS: ack=false settings=[id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438]
09:53:46.656 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND SETTINGS: ack=true
09:53:46.658 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND SETTINGS: ack=true
09:53:46.659 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:46.665 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:53:46.665 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND PING: ack=false bytes=1234
09:53:46.666 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND PING: ack=true bytes=1234
09:53:46.667 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
09:53:46.668 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND RST_STREAM: streamId=1 errorCode=0
09:53:46.669 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:46.670 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:53:46.670 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND PING: ack=false bytes=1234
09:53:46.671 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND PING: ack=true bytes=1234
09:53:46.682 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:46.687 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
09:53:46.688 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
09:53:46.688 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND PING: ack=false bytes=145258749040133895
09:53:46.688 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND PING: ack=true bytes=145258749040133895
09:53:46.688 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:46.689 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND DATA: streamId=5 padding=0 endStream=true length=603 bytes=00000002560ad3043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:53:46.689 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND PING: ack=false bytes=1234
09:53:46.690 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND PING: ack=true bytes=1234
09:53:46.692 [pool-1-thread-16] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 595
09:53:46.698 [pool-1-thread-16] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:53:46.724 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:53:46.726 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=3 padding=0 endStream=true length=603 bytes=000000025612d3043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:53:46.727 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
09:53:46.730 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
09:53:46.731 [pool-1-thread-17] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:53:46.731 [pool-1-thread-17] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string"/></Apply></Condition></Rule></Policy>
09:53:46.732 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:53:46.737 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=3 padding=0 endStream=true length=603 bytes=000000025612d3043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:53:46.739 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
09:53:46.740 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:46.741 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:53:46.741 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:46.751 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
09:53:46.753 [pool-1-thread-19] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:53:46.757 [pool-1-thread-19] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string"/></Apply></Condition></Rule></Policy>
09:53:46.761 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:53:46.762 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
09:53:46.762 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
09:53:46.764 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:46.765 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:53:46.766 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:53:46.766 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
09:53:46.766 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
09:53:46.767 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:49.050 [pool-1-thread-16] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=200, message=null
09:53:49.057 [pool-1-thread-16] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response body: Policy uploaded successfully with ID: 63332a5b-52ee-4fa5-920d-2cf19c84688b
09:53:49.057 [pool-1-thread-16] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyId: 63332a5b-52ee-4fa5-920d-2cf19c84688b
09:53:49.057 [pool-1-thread-16] INFO org.example.policy.service.PolicyServiceImpl - Policy uploaded successfully with ID: 63332a5b-52ee-4fa5-920d-2cf19c84688b
09:53:49.057 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:49.058 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=83 bytes=000000004e0801124a506f6c6963792075706c6f61646564207375636365737366756c6c7920776974682049443a2036333333326135622d353265652d346661...
09:53:49.059 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:49.060 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=83
09:53:49.060 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND PING: ack=false bytes=145258749040133895
09:53:49.060 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND PING: ack=true bytes=145258749040133895
09:53:49.061 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
09:53:49.061 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND PING: ack=false bytes=1234
09:53:49.062 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] INBOUND PING: ack=true bytes=1234
09:53:49.062 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x2cba6968, L:/127.0.0.1:9090 - R:/127.0.0.1:58438] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:49.167 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:53:49.167 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=5 padding=0 endStream=true length=1074 bytes=000000042d0ad4033c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
09:53:49.167 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
09:53:49.168 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
09:53:49.168 [pool-1-thread-6] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"><Attribute AttributeId="role"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Attribute><Attribute AttributeId="policyId"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">63332a5b-52ee-4fa5-920d-2cf19c84688b</AttributeValue></Attribute></Attributes></Request>
09:53:49.177 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:53:49.178 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=5 padding=0 endStream=true length=1074 bytes=000000042d0ad4033c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
09:53:49.181 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
09:53:49.182 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
09:53:49.182 [pool-1-thread-9] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"><Attribute AttributeId="role"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Attribute><Attribute AttributeId="policyId"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">63332a5b-52ee-4fa5-920d-2cf19c84688b</AttributeValue></Attribute></Attributes></Request>
09:53:49.230 [pool-1-thread-6] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 63332a5b-52ee-4fa5-920d-2cf19c84688b, responseCode: 200
09:53:49.238 [pool-1-thread-6] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"63332a5b-52ee-4fa5-920d-2cf19c84688b","name":"UploadedPolicy","content":"<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"><Target/><Rule Effect=\"Permit\" RuleId=\"rule1\"><Condition><Apply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">admin</AttributeValue><AttributeDesignator AttributeId=\"role\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" DataType=\"http://www.w3.org/2001/XMLSchema#string\"/></Apply></Condition></Rule></Policy>","version":"1.0","status":"active","createdAt":"2025-02-24T01:53:46.709006321Z","updatedAt":"2025-02-24T01:53:46.709006321Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
09:53:49.261 [pool-1-thread-9] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 63332a5b-52ee-4fa5-920d-2cf19c84688b, responseCode: 200
09:53:49.261 [pool-1-thread-9] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"63332a5b-52ee-4fa5-920d-2cf19c84688b","name":"UploadedPolicy","content":"<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"><Target/><Rule Effect=\"Permit\" RuleId=\"rule1\"><Condition><Apply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">admin</AttributeValue><AttributeDesignator AttributeId=\"role\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" DataType=\"http://www.w3.org/2001/XMLSchema#string\"/></Apply></Condition></Rule></Policy>","version":"1.0","status":"active","createdAt":"2025-02-24T01:53:46.709006321Z","updatedAt":"2025-02-24T01:53:46.709006321Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
09:53:49.518 [pool-1-thread-9] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string"/></Apply></Condition></Rule></Policy>
09:53:49.521 [pool-1-thread-6] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string"/></Apply></Condition></Rule></Policy>
09:53:49.542 [pool-1-thread-9] ERROR org.example.policy.service.PolicyServiceImpl - Error evaluating policy
java.lang.RuntimeException: Error evaluating request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:133)
	at org.example.policy.service.PolicyServiceImpl.evaluatePolicy(PolicyServiceImpl.java:20)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:424)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.wso2.balana.ParsingException: Required MustBePresent missing in AttributeDesignator
	at org.wso2.balana.attr.xacml3.AttributeDesignator.getInstance(AttributeDesignator.java:136)
	at org.wso2.balana.attr.AttributeDesignatorFactory.getAbstractDesignator(AttributeDesignatorFactory.java:38)
	at org.wso2.balana.cond.ExpressionHandler.parseExpression(ExpressionHandler.java:61)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:221)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:188)
	at org.wso2.balana.cond.ExpressionHandler.parseExpression(ExpressionHandler.java:53)
	at org.wso2.balana.cond.Condition.getInstance(Condition.java:177)
	at org.wso2.balana.Rule.getInstance(Rule.java:237)
	at org.wso2.balana.Policy.<init>(Policy.java:303)
	at org.wso2.balana.Policy.getInstance(Policy.java:382)
	at org.example.policy.engine.DigitalTwinPolicyEngine$ChainPolicyFinderModule.updatePolicy(DigitalTwinPolicyEngine.java:262)
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:126)
	... 10 common frames omitted
Caused by: java.lang.NullPointerException: Cannot invoke "org.w3c.dom.Node.getNodeValue()" because the return value of "org.w3c.dom.NamedNodeMap.getNamedItem(String)" is null
	at org.wso2.balana.attr.xacml3.AttributeDesignator.getInstance(AttributeDesignator.java:131)
	... 21 common frames omitted
09:53:49.543 [pool-1-thread-6] ERROR org.example.policy.service.PolicyServiceImpl - Error evaluating policy
java.lang.RuntimeException: Error evaluating request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:133)
	at org.example.policy.service.PolicyServiceImpl.evaluatePolicy(PolicyServiceImpl.java:20)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:424)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.wso2.balana.ParsingException: Required MustBePresent missing in AttributeDesignator
	at org.wso2.balana.attr.xacml3.AttributeDesignator.getInstance(AttributeDesignator.java:136)
	at org.wso2.balana.attr.AttributeDesignatorFactory.getAbstractDesignator(AttributeDesignatorFactory.java:38)
	at org.wso2.balana.cond.ExpressionHandler.parseExpression(ExpressionHandler.java:61)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:221)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:188)
	at org.wso2.balana.cond.ExpressionHandler.parseExpression(ExpressionHandler.java:53)
	at org.wso2.balana.cond.Condition.getInstance(Condition.java:177)
	at org.wso2.balana.Rule.getInstance(Rule.java:237)
	at org.wso2.balana.Policy.<init>(Policy.java:303)
	at org.wso2.balana.Policy.getInstance(Policy.java:382)
	at org.example.policy.engine.DigitalTwinPolicyEngine$ChainPolicyFinderModule.updatePolicy(DigitalTwinPolicyEngine.java:262)
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:126)
	... 10 common frames omitted
Caused by: java.lang.NullPointerException: Cannot invoke "org.w3c.dom.Node.getNodeValue()" because the return value of "org.w3c.dom.NamedNodeMap.getNamedItem(String)" is null
	at org.wso2.balana.attr.xacml3.AttributeDesignator.getInstance(AttributeDesignator.java:131)
	... 21 common frames omitted
09:53:49.544 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:49.545 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=31 bytes=000000001a1a184572726f72206576616c756174696e672072657175657374
09:53:49.545 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=31
09:53:49.545 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
09:53:49.545 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
09:53:49.546 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:49.552 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:53:49.552 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=31 bytes=000000001a1a184572726f72206576616c756174696e672072657175657374
09:53:49.552 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:53:49.563 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=31
09:53:49.563 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
09:53:49.563 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
09:56:38.213 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
09:56:38.213 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
09:56:38.214 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND SETTINGS: ack=false settings=[id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966]
09:56:38.215 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND SETTINGS: ack=true
09:56:38.216 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND SETTINGS: ack=true
09:56:38.216 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:56:38.216 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:56:38.216 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND PING: ack=false bytes=1234
09:56:38.217 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
09:56:38.218 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND PING: ack=true bytes=1234
09:56:38.218 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND RST_STREAM: streamId=1 errorCode=0
09:56:38.219 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:56:38.219 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:56:38.219 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND PING: ack=false bytes=1234
09:56:38.219 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND PING: ack=true bytes=1234
09:56:38.220 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:56:38.220 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
09:56:38.223 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
09:56:38.223 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND PING: ack=false bytes=145258749040133895
09:56:38.223 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND PING: ack=true bytes=145258749040133895
09:56:38.223 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:56:38.226 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND DATA: streamId=5 padding=0 endStream=true length=625 bytes=000000026c0ae9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:56:38.226 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND PING: ack=false bytes=1234
09:56:38.227 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND PING: ack=true bytes=1234
09:56:38.228 [pool-1-thread-18] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 617
09:56:38.230 [pool-1-thread-18] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:56:38.263 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=7 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:56:38.269 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=7 padding=0 endStream=true length=625 bytes=000000026c12e9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:56:38.270 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
09:56:38.272 [pool-1-thread-20] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:56:38.272 [pool-1-thread-20] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></Apply></Condition></Rule></Policy>
09:56:38.274 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
09:56:38.276 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=7 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:56:38.278 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=7 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:56:38.279 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=7 padding=0 endStream=true length=625 bytes=000000026c12e9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:56:38.280 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
09:56:38.280 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
09:56:38.280 [pool-1-thread-1] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:56:38.280 [pool-1-thread-1] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></Apply></Condition></Rule></Policy>
09:56:38.282 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=7 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:56:38.283 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=7 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:56:38.283 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=7 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:56:38.283 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:56:38.283 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
09:56:38.284 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
09:56:38.283 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=7 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:56:38.284 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=7 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:56:38.286 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:56:38.286 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
09:56:38.286 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
09:56:40.542 [pool-1-thread-18] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=200, message=null
09:56:40.544 [pool-1-thread-18] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response body: Policy uploaded successfully with ID: c64f7650-b94b-46d4-88e4-cdcdeecfdaa2
09:56:40.544 [pool-1-thread-18] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyId: c64f7650-b94b-46d4-88e4-cdcdeecfdaa2
09:56:40.544 [pool-1-thread-18] INFO org.example.policy.service.PolicyServiceImpl - Policy uploaded successfully with ID: c64f7650-b94b-46d4-88e4-cdcdeecfdaa2
09:56:40.546 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:56:40.548 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=83 bytes=000000004e0801124a506f6c6963792075706c6f61646564207375636365737366756c6c7920776974682049443a2063363466373635302d623934622d343664...
09:56:40.548 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:56:40.548 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=83
09:56:40.549 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND PING: ack=false bytes=145258749040133895
09:56:40.549 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND PING: ack=true bytes=145258749040133895
09:56:40.549 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
09:56:40.549 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND PING: ack=false bytes=1234
09:56:40.549 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:56:40.551 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x90439bb8, L:/127.0.0.1:9090 - R:/127.0.0.1:32966] INBOUND PING: ack=true bytes=1234
09:56:40.581 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=9 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:56:40.582 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=9 padding=0 endStream=true length=1096 bytes=00000004430ad4033c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
09:56:40.582 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
09:56:40.585 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
09:56:40.586 [pool-1-thread-6] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"><Attribute AttributeId="role"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Attribute><Attribute AttributeId="policyId"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">c64f7650-b94b-46d4-88e4-cdcdeecfdaa2</AttributeValue></Attribute></Attributes></Request>
09:56:40.594 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=9 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:56:40.595 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=9 padding=0 endStream=true length=1096 bytes=00000004430ad4033c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
09:56:40.595 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
09:56:40.600 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
09:56:40.601 [pool-1-thread-5] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"><Attribute AttributeId="role"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Attribute><Attribute AttributeId="policyId"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">c64f7650-b94b-46d4-88e4-cdcdeecfdaa2</AttributeValue></Attribute></Attributes></Request>
09:56:40.620 [pool-1-thread-6] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: c64f7650-b94b-46d4-88e4-cdcdeecfdaa2, responseCode: 200
09:56:40.620 [pool-1-thread-6] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"c64f7650-b94b-46d4-88e4-cdcdeecfdaa2","name":"UploadedPolicy","content":"<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"><Target/><Rule Effect=\"Permit\" RuleId=\"rule1\"><Condition><Apply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">admin</AttributeValue><AttributeDesignator AttributeId=\"role\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"/></Apply></Condition></Rule></Policy>","version":"1.0","status":"active","createdAt":"2025-02-24T01:56:38.238663866Z","updatedAt":"2025-02-24T01:56:38.238663866Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
09:56:40.621 [pool-1-thread-6] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></Apply></Condition></Rule></Policy>
09:56:40.626 [pool-1-thread-6] ERROR org.example.policy.service.PolicyServiceImpl - Error evaluating policy
java.lang.RuntimeException: Error evaluating request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:133)
	at org.example.policy.service.PolicyServiceImpl.evaluatePolicy(PolicyServiceImpl.java:20)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:424)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.IllegalArgumentException: illegal parameter
	at org.wso2.balana.cond.FunctionBase.checkInputs(FunctionBase.java:365)
	at org.wso2.balana.cond.Apply.<init>(Apply.java:89)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:227)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:188)
	at org.wso2.balana.cond.ExpressionHandler.parseExpression(ExpressionHandler.java:53)
	at org.wso2.balana.cond.Condition.getInstance(Condition.java:177)
	at org.wso2.balana.Rule.getInstance(Rule.java:237)
	at org.wso2.balana.Policy.<init>(Policy.java:303)
	at org.wso2.balana.Policy.getInstance(Policy.java:382)
	at org.example.policy.engine.DigitalTwinPolicyEngine$ChainPolicyFinderModule.updatePolicy(DigitalTwinPolicyEngine.java:262)
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:126)
	... 10 common frames omitted
09:56:40.627 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=9 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:56:40.629 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=9 padding=0 endStream=false length=31 bytes=000000001a1a184572726f72206576616c756174696e672072657175657374
09:56:40.630 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=31
09:56:40.630 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
09:56:40.630 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
09:56:40.631 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=9 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:56:40.640 [pool-1-thread-5] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: c64f7650-b94b-46d4-88e4-cdcdeecfdaa2, responseCode: 200
09:56:40.641 [pool-1-thread-5] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"c64f7650-b94b-46d4-88e4-cdcdeecfdaa2","name":"UploadedPolicy","content":"<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"><Target/><Rule Effect=\"Permit\" RuleId=\"rule1\"><Condition><Apply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">admin</AttributeValue><AttributeDesignator AttributeId=\"role\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"/></Apply></Condition></Rule></Policy>","version":"1.0","status":"active","createdAt":"2025-02-24T01:56:38.238663866Z","updatedAt":"2025-02-24T01:56:38.238663866Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
09:56:40.642 [pool-1-thread-5] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/></Apply></Condition></Rule></Policy>
09:56:40.644 [pool-1-thread-5] ERROR org.example.policy.service.PolicyServiceImpl - Error evaluating policy
java.lang.RuntimeException: Error evaluating request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:133)
	at org.example.policy.service.PolicyServiceImpl.evaluatePolicy(PolicyServiceImpl.java:20)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:424)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.IllegalArgumentException: illegal parameter
	at org.wso2.balana.cond.FunctionBase.checkInputs(FunctionBase.java:365)
	at org.wso2.balana.cond.Apply.<init>(Apply.java:89)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:227)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:188)
	at org.wso2.balana.cond.ExpressionHandler.parseExpression(ExpressionHandler.java:53)
	at org.wso2.balana.cond.Condition.getInstance(Condition.java:177)
	at org.wso2.balana.Rule.getInstance(Rule.java:237)
	at org.wso2.balana.Policy.<init>(Policy.java:303)
	at org.wso2.balana.Policy.getInstance(Policy.java:382)
	at org.example.policy.engine.DigitalTwinPolicyEngine$ChainPolicyFinderModule.updatePolicy(DigitalTwinPolicyEngine.java:262)
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:126)
	... 10 common frames omitted
09:56:40.644 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=9 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:56:40.644 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=9 padding=0 endStream=false length=31 bytes=000000001a1a184572726f72206576616c756174696e672072657175657374
09:56:40.644 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=9 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:56:40.648 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=31
09:56:40.649 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
09:56:40.649 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
09:59:42.886 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
09:59:42.886 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
09:59:42.886 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND SETTINGS: ack=false settings=[id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360]
09:59:42.886 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND SETTINGS: ack=true
09:59:42.888 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND SETTINGS: ack=true
09:59:42.888 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:42.889 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:59:42.889 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND PING: ack=false bytes=1234
09:59:42.892 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND PING: ack=true bytes=1234
09:59:42.893 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
09:59:42.896 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND RST_STREAM: streamId=1 errorCode=0
09:59:42.897 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:42.900 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:59:42.900 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND PING: ack=false bytes=1234
09:59:42.903 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:42.906 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
09:59:42.911 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND PING: ack=true bytes=1234
09:59:42.911 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
09:59:42.911 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND PING: ack=false bytes=145258749040133895
09:59:42.912 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND PING: ack=true bytes=145258749040133895
09:59:42.915 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:42.917 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND DATA: streamId=5 padding=0 endStream=true length=625 bytes=000000026c0ae9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:59:42.917 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND PING: ack=false bytes=1234
09:59:42.918 [pool-1-thread-20] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 617
09:59:42.921 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND PING: ack=true bytes=1234
09:59:42.926 [pool-1-thread-20] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:59:42.952 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=11 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:59:42.953 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=11 padding=0 endStream=true length=625 bytes=000000026c12e9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:59:42.953 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
09:59:42.954 [pool-1-thread-16] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:59:42.954 [pool-1-thread-16] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Apply></Condition></Rule></Policy>
09:59:42.955 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
09:59:42.960 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=11 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:59:42.960 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=11 padding=0 endStream=true length=625 bytes=000000026c12e9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:59:42.960 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
09:59:42.961 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
09:59:42.961 [pool-1-thread-18] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:59:42.961 [pool-1-thread-18] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Apply></Condition></Rule></Policy>
09:59:42.967 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=11 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:42.968 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=11 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:59:42.968 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=11 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:59:42.974 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:59:42.975 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
09:59:42.975 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
09:59:42.980 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=11 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:42.982 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=11 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:59:42.982 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=11 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:59:42.986 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:59:42.986 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
09:59:42.987 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
09:59:45.097 [pool-1-thread-20] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=500, message=null
09:59:45.097 [pool-1-thread-20] ERROR org.example.policy.engine.DigitalTwinPolicyEngine - Upload failed with error response: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:59:42.93091858Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:59:42.93091858Z' could not be parsed at index 20 at [Source: (String)"[{"id":"4b9ab72c-d04f-4b33-a48a-8668576d3ee5","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeDesignator AttributeId=\"role\" Cate"[truncated 688 chars]; line: 1, column: 889] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
09:59:45.098 [pool-1-thread-20] ERROR org.example.policy.engine.DigitalTwinPolicyEngine - Failed to upload policy to Fabric-Client: Upload failed with status 500: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:59:42.93091858Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:59:42.93091858Z' could not be parsed at index 20 at [Source: (String)"[{"id":"4b9ab72c-d04f-4b33-a48a-8668576d3ee5","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeDesignator AttributeId=\"role\" Cate"[truncated 688 chars]; line: 1, column: 889] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
java.lang.RuntimeException: Upload failed with status 500: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:59:42.93091858Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:59:42.93091858Z' could not be parsed at index 20 at [Source: (String)"[{"id":"4b9ab72c-d04f-4b33-a48a-8668576d3ee5","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeDesignator AttributeId=\"role\" Cate"[truncated 688 chars]; line: 1, column: 889] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
	at org.example.policy.engine.DigitalTwinPolicyEngine.uploadPolicy(DigitalTwinPolicyEngine.java:218)
	at org.example.policy.service.PolicyServiceImpl.uploadPolicy(PolicyServiceImpl.java:94)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:436)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
09:59:45.098 [pool-1-thread-20] ERROR org.example.policy.service.PolicyServiceImpl - Error uploading policy
java.lang.RuntimeException: Failed to upload policy to Fabric-Client
	at org.example.policy.engine.DigitalTwinPolicyEngine.uploadPolicy(DigitalTwinPolicyEngine.java:231)
	at org.example.policy.service.PolicyServiceImpl.uploadPolicy(PolicyServiceImpl.java:94)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:436)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.RuntimeException: Upload failed with status 500: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:59:42.93091858Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:59:42.93091858Z' could not be parsed at index 20 at [Source: (String)"[{"id":"4b9ab72c-d04f-4b33-a48a-8668576d3ee5","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeDesignator AttributeId=\"role\" Cate"[truncated 688 chars]; line: 1, column: 889] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
	at org.example.policy.engine.DigitalTwinPolicyEngine.uploadPolicy(DigitalTwinPolicyEngine.java:218)
	... 10 common frames omitted
09:59:45.099 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:45.099 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=54 bytes=0000000031122f4572726f723a204661696c656420746f2075706c6f616420706f6c69637920746f204661627269632d436c69656e74
09:59:45.099 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:59:45.100 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=54
09:59:45.103 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND PING: ack=false bytes=145258749040133895
09:59:45.103 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND PING: ack=true bytes=145258749040133895
09:59:45.104 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
09:59:45.104 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND PING: ack=false bytes=1234
09:59:45.111 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] INBOUND PING: ack=true bytes=1234
09:59:45.113 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdc94698b, L:/127.0.0.1:9090 - R:/127.0.0.1:43360] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:59:47.599 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
09:59:47.599 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
09:59:47.600 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND SETTINGS: ack=false settings=[id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366]
09:59:47.600 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND SETTINGS: ack=true
09:59:47.604 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND SETTINGS: ack=true
09:59:47.606 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:47.608 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:59:47.608 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND PING: ack=false bytes=1234
09:59:47.609 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
09:59:47.615 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND PING: ack=true bytes=1234
09:59:47.615 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND RST_STREAM: streamId=1 errorCode=0
09:59:47.617 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:47.618 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
09:59:47.618 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND PING: ack=false bytes=1234
09:59:47.621 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND PING: ack=true bytes=1234
09:59:47.623 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:47.624 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
09:59:47.638 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
09:59:47.639 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND PING: ack=false bytes=145258749040133895
09:59:47.639 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND PING: ack=true bytes=145258749040133895
09:59:47.639 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:47.641 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND DATA: streamId=5 padding=0 endStream=true length=625 bytes=000000026c0ae9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:59:47.642 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND PING: ack=false bytes=1234
09:59:47.645 [pool-1-thread-15] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 617
09:59:47.647 [pool-1-thread-15] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:59:47.671 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=13 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:59:47.672 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=13 padding=0 endStream=true length=625 bytes=000000026c12e9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:59:47.674 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
09:59:47.675 [pool-1-thread-19] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:59:47.675 [pool-1-thread-19] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Apply></Condition></Rule></Policy>
09:59:47.676 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
09:59:47.676 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND PING: ack=true bytes=1234
09:59:47.679 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=13 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
09:59:47.679 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=13 padding=0 endStream=true length=625 bytes=000000026c12e9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
09:59:47.679 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
09:59:47.681 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=13 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:47.681 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=13 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:59:47.681 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=13 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:59:47.682 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:59:47.682 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
09:59:47.682 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
09:59:47.683 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
09:59:47.684 [pool-1-thread-18] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
09:59:47.684 [pool-1-thread-18] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Apply></Condition></Rule></Policy>
09:59:47.691 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=13 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:47.692 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=13 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
09:59:47.692 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=13 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:59:47.704 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
09:59:47.704 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
09:59:47.704 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
09:59:49.839 [pool-1-thread-15] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=500, message=null
09:59:49.839 [pool-1-thread-15] ERROR org.example.policy.engine.DigitalTwinPolicyEngine - Upload failed with error response: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:59:47.65120596Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:59:47.65120596Z' could not be parsed at index 20 at [Source: (String)"[{"id":"4cf6e1bb-f7f7-4438-85a2-aab10a259672","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeDesignator AttributeId=\"role\" Cate"[truncated 688 chars]; line: 1, column: 889] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
09:59:49.840 [pool-1-thread-15] ERROR org.example.policy.engine.DigitalTwinPolicyEngine - Failed to upload policy to Fabric-Client: Upload failed with status 500: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:59:47.65120596Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:59:47.65120596Z' could not be parsed at index 20 at [Source: (String)"[{"id":"4cf6e1bb-f7f7-4438-85a2-aab10a259672","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeDesignator AttributeId=\"role\" Cate"[truncated 688 chars]; line: 1, column: 889] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
java.lang.RuntimeException: Upload failed with status 500: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:59:47.65120596Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:59:47.65120596Z' could not be parsed at index 20 at [Source: (String)"[{"id":"4cf6e1bb-f7f7-4438-85a2-aab10a259672","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeDesignator AttributeId=\"role\" Cate"[truncated 688 chars]; line: 1, column: 889] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
	at org.example.policy.engine.DigitalTwinPolicyEngine.uploadPolicy(DigitalTwinPolicyEngine.java:218)
	at org.example.policy.service.PolicyServiceImpl.uploadPolicy(PolicyServiceImpl.java:94)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:436)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
09:59:49.840 [pool-1-thread-15] ERROR org.example.policy.service.PolicyServiceImpl - Error uploading policy
java.lang.RuntimeException: Failed to upload policy to Fabric-Client
	at org.example.policy.engine.DigitalTwinPolicyEngine.uploadPolicy(DigitalTwinPolicyEngine.java:231)
	at org.example.policy.service.PolicyServiceImpl.uploadPolicy(PolicyServiceImpl.java:94)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:436)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.RuntimeException: Upload failed with status 500: Failed to upload policy: 策略数据解析失败: Cannot deserialize value of type `java.time.Instant` from String "2025-02-24T01:59:47.65120596Z": Failed to deserialize java.time.Instant: (java.time.format.DateTimeParseException) Text '2025-02-24T01:59:47.65120596Z' could not be parsed at index 20 at [Source: (String)"[{"id":"4cf6e1bb-f7f7-4438-85a2-aab10a259672","name":"UploadedPolicy","content":"\u003cPolicy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"\u003e\u003cTarget/\u003e\u003cRule Effect=\"Permit\" RuleId=\"rule1\"\u003e\u003cCondition\u003e\u003cApply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"\u003e\u003cAttributeDesignator AttributeId=\"role\" Cate"[truncated 688 chars]; line: 1, column: 889] (through reference chain: java.lang.Object[][0]->org.denglg.hyperledgerfabric.app.javademo.pojo.constant.Policy["createdAt"])
	at org.example.policy.engine.DigitalTwinPolicyEngine.uploadPolicy(DigitalTwinPolicyEngine.java:218)
	... 10 common frames omitted
09:59:49.841 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
09:59:49.841 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=54 bytes=0000000031122f4572726f723a204661696c656420746f2075706c6f616420706f6c69637920746f204661627269632d436c69656e74
09:59:49.841 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
09:59:49.842 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=54
09:59:49.842 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND PING: ack=false bytes=145258749040133895
09:59:49.842 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND PING: ack=true bytes=145258749040133895
09:59:49.842 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
09:59:49.842 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND PING: ack=false bytes=1234
09:59:49.843 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] INBOUND PING: ack=true bytes=1234
09:59:49.843 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xcb184d82, L:/127.0.0.1:9090 - R:/127.0.0.1:43366] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:00:44.208 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:00:44.209 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:00:44.210 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND SETTINGS: ack=false settings=[id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854]
10:00:44.210 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND SETTINGS: ack=true
10:00:44.212 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND SETTINGS: ack=true
10:00:44.212 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:00:44.212 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:00:44.212 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND PING: ack=false bytes=1234
10:00:44.213 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:00:44.218 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND PING: ack=true bytes=1234
10:00:44.219 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND RST_STREAM: streamId=1 errorCode=0
10:00:44.219 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:00:44.220 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:00:44.221 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND PING: ack=false bytes=1234
10:00:44.223 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:00:44.223 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:00:44.224 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND PING: ack=true bytes=1234
10:00:44.225 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:00:44.225 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND PING: ack=false bytes=145258749040133895
10:00:44.226 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND PING: ack=true bytes=145258749040133895
10:00:44.226 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:00:44.227 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND DATA: streamId=5 padding=0 endStream=true length=625 bytes=000000026c0ae9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
10:00:44.231 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND PING: ack=false bytes=1234
10:00:44.233 [pool-1-thread-13] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 617
10:00:44.235 [pool-1-thread-13] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
10:00:44.237 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND PING: ack=true bytes=1234
10:00:44.256 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=15 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:00:44.257 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=15 padding=0 endStream=true length=625 bytes=000000026c12e9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
10:00:44.257 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:00:44.258 [pool-1-thread-17] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
10:00:44.258 [pool-1-thread-17] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Apply></Condition></Rule></Policy>
10:00:44.259 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:00:44.261 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=15 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:00:44.261 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=15 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:00:44.262 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=15 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:00:44.262 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=15 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:00:44.266 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:00:44.266 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:00:44.266 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:00:44.267 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=15 padding=0 endStream=true length=625 bytes=000000026c12e9043c506f6c69637920786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d613a...
10:00:44.268 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:00:44.268 [pool-1-thread-16] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:s
10:00:44.268 [pool-1-thread-16] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Apply></Condition></Rule></Policy>
10:00:44.269 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:00:44.270 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=15 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:00:44.271 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=15 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:00:44.271 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=15 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:00:44.273 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:00:44.273 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:00:44.274 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:00:46.405 [pool-1-thread-13] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=200, message=null
10:00:46.406 [pool-1-thread-13] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response body: Policy uploaded successfully with ID: 6a5299ae-6f77-44b9-826f-1797dbd756c8
10:00:46.406 [pool-1-thread-13] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyId: 6a5299ae-6f77-44b9-826f-1797dbd756c8
10:00:46.406 [pool-1-thread-13] INFO org.example.policy.service.PolicyServiceImpl - Policy uploaded successfully with ID: 6a5299ae-6f77-44b9-826f-1797dbd756c8
10:00:46.407 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:00:46.407 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=83 bytes=000000004e0801124a506f6c6963792075706c6f61646564207375636365737366756c6c7920776974682049443a2036613532393961652d366637372d343462...
10:00:46.407 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:00:46.409 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=83
10:00:46.409 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND PING: ack=false bytes=145258749040133895
10:00:46.409 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND PING: ack=true bytes=145258749040133895
10:00:46.409 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:00:46.409 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND PING: ack=false bytes=1234
10:00:46.409 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:00:46.409 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdf823e31, L:/127.0.0.1:9090 - R:/127.0.0.1:41854] INBOUND PING: ack=true bytes=1234
10:00:46.466 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=17 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:00:46.466 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=17 padding=0 endStream=true length=1096 bytes=00000004430ad4033c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:00:46.466 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:00:46.468 [pool-1-thread-20] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"><Attribute AttributeId="role"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Attribute><Attribute AttributeId="policyId"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">6a5299ae-6f77-44b9-826f-1797dbd756c8</AttributeValue></Attribute></Attributes></Request>
10:00:46.476 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:00:46.478 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=17 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:00:46.478 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=17 padding=0 endStream=true length=1096 bytes=00000004430ad4033c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:00:46.478 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:00:46.480 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:00:46.482 [pool-1-thread-8] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"><Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"><Attribute AttributeId="role"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Attribute><Attribute AttributeId="policyId"><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">6a5299ae-6f77-44b9-826f-1797dbd756c8</AttributeValue></Attribute></Attributes></Request>
10:00:46.521 [pool-1-thread-20] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 6a5299ae-6f77-44b9-826f-1797dbd756c8, responseCode: 200
10:00:46.524 [pool-1-thread-20] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"6a5299ae-6f77-44b9-826f-1797dbd756c8","name":"UploadedPolicy","content":"<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"><Target/><Rule Effect=\"Permit\" RuleId=\"rule1\"><Condition><Apply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><AttributeDesignator AttributeId=\"role\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"/><AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">admin</AttributeValue></Apply></Condition></Rule></Policy>","version":"1.0","status":"active","createdAt":"2025-02-24T02:00:44.240412954Z","updatedAt":"2025-02-24T02:00:44.240412954Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:00:46.525 [pool-1-thread-20] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Apply></Condition></Rule></Policy>
10:00:46.529 [pool-1-thread-20] ERROR org.example.policy.service.PolicyServiceImpl - Error evaluating policy
java.lang.RuntimeException: Error evaluating request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:133)
	at org.example.policy.service.PolicyServiceImpl.evaluatePolicy(PolicyServiceImpl.java:20)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:424)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.IllegalArgumentException: illegal parameter
	at org.wso2.balana.cond.FunctionBase.checkInputs(FunctionBase.java:365)
	at org.wso2.balana.cond.Apply.<init>(Apply.java:89)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:227)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:188)
	at org.wso2.balana.cond.ExpressionHandler.parseExpression(ExpressionHandler.java:53)
	at org.wso2.balana.cond.Condition.getInstance(Condition.java:177)
	at org.wso2.balana.Rule.getInstance(Rule.java:237)
	at org.wso2.balana.Policy.<init>(Policy.java:303)
	at org.wso2.balana.Policy.getInstance(Policy.java:382)
	at org.example.policy.engine.DigitalTwinPolicyEngine$ChainPolicyFinderModule.updatePolicy(DigitalTwinPolicyEngine.java:262)
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:126)
	... 10 common frames omitted
10:00:46.530 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=17 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:00:46.530 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=17 padding=0 endStream=false length=31 bytes=000000001a1a184572726f72206576616c756174696e672072657175657374
10:00:46.531 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=31
10:00:46.531 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:00:46.531 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:00:46.531 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=17 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:00:46.541 [pool-1-thread-8] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 6a5299ae-6f77-44b9-826f-1797dbd756c8, responseCode: 200
10:00:46.542 [pool-1-thread-8] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"6a5299ae-6f77-44b9-826f-1797dbd756c8","name":"UploadedPolicy","content":"<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" PolicyId=\"test_policy\" RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\"><Target/><Rule Effect=\"Permit\" RuleId=\"rule1\"><Condition><Apply FunctionId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\"><AttributeDesignator AttributeId=\"role\" Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" DataType=\"http://www.w3.org/2001/XMLSchema#string\" MustBePresent=\"false\"/><AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">admin</AttributeValue></Apply></Condition></Rule></Policy>","version":"1.0","status":"active","createdAt":"2025-02-24T02:00:44.240412954Z","updatedAt":"2025-02-24T02:00:44.240412954Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:00:46.543 [pool-1-thread-8] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="test_policy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides"><Target/><Rule Effect="Permit" RuleId="rule1"><Condition><Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"><AttributeDesignator AttributeId="role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="false"/><AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">admin</AttributeValue></Apply></Condition></Rule></Policy>
10:00:46.545 [pool-1-thread-8] ERROR org.example.policy.service.PolicyServiceImpl - Error evaluating policy
java.lang.RuntimeException: Error evaluating request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:133)
	at org.example.policy.service.PolicyServiceImpl.evaluatePolicy(PolicyServiceImpl.java:20)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:424)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.IllegalArgumentException: illegal parameter
	at org.wso2.balana.cond.FunctionBase.checkInputs(FunctionBase.java:365)
	at org.wso2.balana.cond.Apply.<init>(Apply.java:89)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:227)
	at org.wso2.balana.cond.Apply.getInstance(Apply.java:188)
	at org.wso2.balana.cond.ExpressionHandler.parseExpression(ExpressionHandler.java:53)
	at org.wso2.balana.cond.Condition.getInstance(Condition.java:177)
	at org.wso2.balana.Rule.getInstance(Rule.java:237)
	at org.wso2.balana.Policy.<init>(Policy.java:303)
	at org.wso2.balana.Policy.getInstance(Policy.java:382)
	at org.example.policy.engine.DigitalTwinPolicyEngine$ChainPolicyFinderModule.updatePolicy(DigitalTwinPolicyEngine.java:262)
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:126)
	... 10 common frames omitted
10:00:46.546 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=17 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:00:46.547 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=17 padding=0 endStream=false length=31 bytes=000000001a1a184572726f72206576616c756174696e672072657175657374
10:00:46.547 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=17 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:00:46.549 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=31
10:00:46.549 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:00:46.549 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:04:58.970 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:04:58.970 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:04:58.971 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND SETTINGS: ack=false settings=[id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632]
10:04:58.971 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND SETTINGS: ack=true
10:04:58.971 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND SETTINGS: ack=true
10:04:58.972 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:04:58.972 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:04:58.972 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND PING: ack=false bytes=1234
10:04:58.972 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:04:58.973 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND PING: ack=true bytes=1234
10:04:58.973 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND RST_STREAM: streamId=1 errorCode=0
10:04:58.973 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:04:58.974 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:04:58.974 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND PING: ack=false bytes=1234
10:04:58.975 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:04:58.976 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:04:58.985 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND PING: ack=true bytes=1234
10:04:58.985 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:04:58.985 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND PING: ack=false bytes=145258749040133895
10:04:58.985 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND PING: ack=true bytes=145258749040133895
10:04:58.986 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:04:58.987 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND PING: ack=false bytes=1234
10:04:58.987 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:04:58.988 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xfe6a527b, L:/127.0.0.1:9090 - R:/127.0.0.1:58632] INBOUND PING: ack=true bytes=1234
10:06:40.592 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:06:40.592 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:06:40.596 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND SETTINGS: ack=false settings=[id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664]
10:06:40.596 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND SETTINGS: ack=true
10:06:40.597 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND SETTINGS: ack=true
10:06:40.598 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:06:40.599 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:06:40.601 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND PING: ack=false bytes=1234
10:06:40.601 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:06:40.604 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND PING: ack=true bytes=1234
10:06:40.604 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND RST_STREAM: streamId=1 errorCode=0
10:06:40.606 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:06:40.607 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:06:40.607 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND PING: ack=false bytes=1234
10:06:40.609 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:06:40.610 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:06:40.612 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND PING: ack=true bytes=1234
10:06:40.613 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:06:40.613 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND PING: ack=false bytes=145258749040133895
10:06:40.613 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND PING: ack=true bytes=145258749040133895
10:06:40.613 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:06:40.613 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND PING: ack=false bytes=1234
10:06:40.615 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd562d061, L:/127.0.0.1:9090 - R:/127.0.0.1:50664] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:06:46.254 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:06:46.255 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:06:46.259 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND SETTINGS: ack=false settings=[id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560]
10:06:46.259 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND SETTINGS: ack=true
10:06:46.259 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND SETTINGS: ack=true
10:06:46.260 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:06:46.261 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:06:46.261 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND PING: ack=false bytes=1234
10:06:46.263 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:06:46.264 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND PING: ack=true bytes=1234
10:06:46.265 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND RST_STREAM: streamId=1 errorCode=0
10:06:46.265 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:06:46.266 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:06:46.266 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND PING: ack=false bytes=1234
10:06:46.269 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:06:46.269 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:06:46.270 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND PING: ack=true bytes=1234
10:06:46.270 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:06:46.270 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND PING: ack=false bytes=145258749040133895
10:06:46.270 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND PING: ack=true bytes=145258749040133895
10:06:46.271 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:06:46.271 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND PING: ack=false bytes=1234
10:06:46.272 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:06:46.280 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x8346aa23, L:/127.0.0.1:9090 - R:/127.0.0.1:36560] INBOUND PING: ack=true bytes=1234
10:11:54.048 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:11:54.048 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:11:54.050 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND SETTINGS: ack=false settings=[id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958]
10:11:54.050 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND SETTINGS: ack=true
10:11:54.051 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND SETTINGS: ack=true
10:11:54.052 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:11:54.054 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:11:54.054 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND PING: ack=false bytes=1234
10:11:54.055 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:11:54.057 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND PING: ack=true bytes=1234
10:11:54.057 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND RST_STREAM: streamId=1 errorCode=0
10:11:54.058 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:11:54.058 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:11:54.058 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND PING: ack=false bytes=1234
10:11:54.059 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND PING: ack=true bytes=1234
10:11:54.061 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:11:54.061 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:11:54.062 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:11:54.063 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND PING: ack=false bytes=145258749040133895
10:11:54.063 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND PING: ack=true bytes=145258749040133895
10:11:54.063 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:11:54.063 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND PING: ack=false bytes=1234
10:11:54.066 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:11:54.070 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa542953c, L:/127.0.0.1:9090 - R:/127.0.0.1:39958] INBOUND PING: ack=true bytes=1234
10:12:43.062 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:12:43.062 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:12:43.062 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND SETTINGS: ack=false settings=[id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288]
10:12:43.062 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND SETTINGS: ack=true
10:12:43.070 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND SETTINGS: ack=true
10:12:43.071 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:12:43.071 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:12:43.071 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND PING: ack=false bytes=1234
10:12:43.072 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:12:43.077 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND PING: ack=true bytes=1234
10:12:43.077 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND RST_STREAM: streamId=1 errorCode=0
10:12:43.079 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:12:43.079 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:12:43.079 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND PING: ack=false bytes=1234
10:12:43.080 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND PING: ack=true bytes=1234
10:12:43.084 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:12:43.088 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:12:43.090 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:12:43.091 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND PING: ack=false bytes=145258749040133895
10:12:43.091 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND PING: ack=true bytes=145258749040133895
10:12:43.092 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:12:43.092 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND DATA: streamId=5 padding=0 endStream=true length=2843 bytes=0000000b160a93163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:12:43.092 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND PING: ack=false bytes=1234
10:12:43.093 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND PING: ack=true bytes=1234
10:12:43.094 [pool-1-thread-7] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 2699
10:12:43.099 [pool-1-thread-7] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:12:43.127 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=19 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:12:43.129 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=19 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:12:43.130 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:12:43.131 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:12:43.134 [pool-1-thread-8] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:12:43.134 [pool-1-thread-8] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:12:43.136 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=19 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:12:43.136 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=19 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:12:43.136 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:12:43.137 [pool-1-thread-5] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:12:43.137 [pool-1-thread-5] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:12:43.138 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=19 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:12:43.138 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=19 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:12:43.139 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=19 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:12:43.139 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=19 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:12:43.139 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=19 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:12:43.139 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=19 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:12:43.140 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:12:43.140 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:12:43.140 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:12:43.140 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:12:43.142 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:12:43.142 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:12:43.142 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:12:45.331 [pool-1-thread-7] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=200, message=null
10:12:45.332 [pool-1-thread-7] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response body: Policy uploaded successfully with ID: d43488e4-3ade-48a8-8fb5-964226ab681c
10:12:45.332 [pool-1-thread-7] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyId: d43488e4-3ade-48a8-8fb5-964226ab681c
10:12:45.332 [pool-1-thread-7] INFO org.example.policy.service.PolicyServiceImpl - Policy uploaded successfully with ID: d43488e4-3ade-48a8-8fb5-964226ab681c
10:12:45.333 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:12:45.333 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=83 bytes=000000004e0801124a506f6c6963792075706c6f61646564207375636365737366756c6c7920776974682049443a2064343334383865342d336164652d343861...
10:12:45.333 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:12:45.334 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=83
10:12:45.334 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND PING: ack=false bytes=145258749040133895
10:12:45.334 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND PING: ack=true bytes=145258749040133895
10:12:45.334 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:12:45.335 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND PING: ack=false bytes=1234
10:12:45.337 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] INBOUND PING: ack=true bytes=1234
10:12:45.337 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x355b849a, L:/127.0.0.1:9090 - R:/127.0.0.1:51288] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:12:45.396 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=21 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:12:45.401 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=21 padding=0 endStream=true length=4219 bytes=00000010760add0a3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:12:45.401 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:12:45.403 [pool-1-thread-19] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:12:45.404 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:12:45.408 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=21 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:12:45.408 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=21 padding=0 endStream=true length=4219 bytes=00000010760add0a3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:12:45.409 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:12:45.409 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:12:45.409 [pool-1-thread-2] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:12:45.411 [pool-1-thread-19] ERROR org.example.policy.service.PolicyServiceImpl - Error evaluating policy
java.lang.RuntimeException: Error evaluating request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:133)
	at org.example.policy.service.PolicyServiceImpl.evaluatePolicy(PolicyServiceImpl.java:20)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:424)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.IllegalArgumentException: Policy ID not found in request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:122)
	... 10 common frames omitted
10:12:45.412 [pool-1-thread-2] ERROR org.example.policy.service.PolicyServiceImpl - Error evaluating policy
java.lang.RuntimeException: Error evaluating request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:133)
	at org.example.policy.service.PolicyServiceImpl.evaluatePolicy(PolicyServiceImpl.java:20)
	at org.example.policy.service.PolicyServiceGrpc$MethodHandlers.invoke(PolicyServiceGrpc.java:424)
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:180)
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:331)
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:814)
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.IllegalArgumentException: Policy ID not found in request
	at org.example.policy.engine.DigitalTwinPolicyEngine.evaluate(DigitalTwinPolicyEngine.java:122)
	... 10 common frames omitted
10:12:45.412 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=21 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:12:45.412 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=21 padding=0 endStream=false length=31 bytes=000000001a1a184572726f72206576616c756174696e672072657175657374
10:12:45.412 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=21 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:12:45.412 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=21 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:12:45.413 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=31
10:12:45.413 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:12:45.413 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:12:45.415 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=21 padding=0 endStream=false length=31 bytes=000000001a1a184572726f72206576616c756174696e672072657175657374
10:12:45.417 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=21 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:12:45.417 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=31
10:12:45.418 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:12:45.418 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:18:16.247 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:18:16.248 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:18:16.251 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND SETTINGS: ack=false settings=[id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584]
10:18:16.251 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND SETTINGS: ack=true
10:18:16.251 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND SETTINGS: ack=true
10:18:16.252 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:18:16.252 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:18:16.252 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND PING: ack=false bytes=1234
10:18:16.252 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:18:16.253 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND PING: ack=true bytes=1234
10:18:16.253 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND RST_STREAM: streamId=1 errorCode=0
10:18:16.253 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:18:16.254 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:18:16.254 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND PING: ack=false bytes=1234
10:18:16.256 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND PING: ack=true bytes=1234
10:18:16.257 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:18:16.258 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:18:16.260 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:18:16.260 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND PING: ack=false bytes=145258749040133895
10:18:16.261 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND PING: ack=true bytes=145258749040133895
10:18:16.261 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:18:16.262 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND PING: ack=false bytes=1234
10:18:16.262 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:18:16.265 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xe8dfb686, L:/127.0.0.1:9090 - R:/127.0.0.1:38584] INBOUND PING: ack=true bytes=1234
10:18:23.132 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:18:23.133 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:18:23.134 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND SETTINGS: ack=false settings=[id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550]
10:18:23.134 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND SETTINGS: ack=true
10:18:23.135 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND SETTINGS: ack=true
10:18:23.135 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:18:23.135 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:18:23.135 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND PING: ack=false bytes=1234
10:18:23.136 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:18:23.136 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND PING: ack=true bytes=1234
10:18:23.138 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND RST_STREAM: streamId=1 errorCode=0
10:18:23.139 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:18:23.139 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:18:23.139 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND PING: ack=false bytes=1234
10:18:23.141 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND PING: ack=true bytes=1234
10:18:23.141 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:18:23.142 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:18:23.143 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:18:23.143 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND PING: ack=false bytes=145258749040133895
10:18:23.143 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND PING: ack=true bytes=145258749040133895
10:18:23.144 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:18:23.144 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND PING: ack=false bytes=1234
10:18:23.145 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] INBOUND PING: ack=true bytes=1234
10:18:23.145 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xa9a7c706, L:/127.0.0.1:9090 - R:/127.0.0.1:47550] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:19:12.726 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:19:12.726 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:19:12.729 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND SETTINGS: ack=false settings=[id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956]
10:19:12.729 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND SETTINGS: ack=true
10:19:12.730 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND SETTINGS: ack=true
10:19:12.730 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:19:12.731 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:19:12.731 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND PING: ack=false bytes=1234
10:19:12.731 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:19:12.732 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND PING: ack=true bytes=1234
10:19:12.732 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND RST_STREAM: streamId=1 errorCode=0
10:19:12.732 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:19:12.732 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:19:12.732 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND PING: ack=false bytes=1234
10:19:12.734 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:19:12.734 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:19:12.734 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND PING: ack=true bytes=1234
10:19:12.737 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:19:12.737 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND PING: ack=false bytes=145258749040133895
10:19:12.737 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND PING: ack=true bytes=145258749040133895
10:19:12.738 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:19:12.740 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND DATA: streamId=5 padding=0 endStream=true length=2843 bytes=0000000b160a93163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:19:12.740 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND PING: ack=false bytes=1234
10:19:12.741 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND PING: ack=true bytes=1234
10:19:12.741 [pool-1-thread-15] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 2699
10:19:12.744 [pool-1-thread-15] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:19:12.787 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=23 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:19:12.788 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=23 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:19:12.788 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:19:12.789 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:19:12.791 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=23 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:19:12.791 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=23 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:19:12.791 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:19:12.792 [pool-1-thread-20] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:19:12.792 [pool-1-thread-20] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:19:12.795 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:19:12.795 [pool-1-thread-20] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:19:12.795 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=23 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:19:12.795 [pool-1-thread-20] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:19:12.796 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=23 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:19:12.797 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=23 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:19:12.797 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:19:12.797 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:19:12.797 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:19:12.806 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=23 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:19:12.806 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=23 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:19:12.806 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=23 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:19:12.808 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:19:12.808 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:19:12.808 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:19:14.966 [pool-1-thread-15] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=200, message=null
10:19:14.969 [pool-1-thread-15] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response body: Policy uploaded successfully with ID: 9c4e17c3-3d93-4d45-a064-479a560a41ee
10:19:14.969 [pool-1-thread-15] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyId: 9c4e17c3-3d93-4d45-a064-479a560a41ee
10:19:14.969 [pool-1-thread-15] INFO org.example.policy.service.PolicyServiceImpl - Policy uploaded successfully with ID: 9c4e17c3-3d93-4d45-a064-479a560a41ee
10:19:14.970 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:19:14.970 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=83 bytes=000000004e0801124a506f6c6963792075706c6f61646564207375636365737366756c6c7920776974682049443a2039633465313763332d336439332d346434...
10:19:14.970 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:19:14.972 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=83
10:19:14.972 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND PING: ack=false bytes=145258749040133895
10:19:14.972 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND PING: ack=true bytes=145258749040133895
10:19:14.972 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:19:14.972 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND PING: ack=false bytes=1234
10:19:14.972 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] INBOUND PING: ack=true bytes=1234
10:19:14.973 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x453fff4d, L:/127.0.0.1:9090 - R:/127.0.0.1:47956] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:19:15.043 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=25 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:19:15.044 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=25 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:19:15.044 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:19:15.047 [pool-1-thread-14] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">9c4e17c3-3d93-4d45-a064-479a560a41ee</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:19:15.048 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:19:15.068 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=25 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:19:15.069 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=25 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:19:15.069 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:19:15.070 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:19:15.071 [pool-1-thread-16] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">9c4e17c3-3d93-4d45-a064-479a560a41ee</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:19:15.118 [pool-1-thread-14] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 9c4e17c3-3d93-4d45-a064-479a560a41ee, responseCode: 200
10:19:15.121 [pool-1-thread-14] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"9c4e17c3-3d93-4d45-a064-479a560a41ee","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:19:12.748737514Z","updatedAt":"2025-02-24T02:19:12.748737514Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:19:15.122 [pool-1-thread-14] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:19:15.128 [pool-1-thread-16] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 9c4e17c3-3d93-4d45-a064-479a560a41ee, responseCode: 200
10:19:15.130 [pool-1-thread-16] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"9c4e17c3-3d93-4d45-a064-479a560a41ee","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:19:12.748737514Z","updatedAt":"2025-02-24T02:19:12.748737514Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:19:15.141 [pool-1-thread-16] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:19:15.150 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=25 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:19:15.151 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=25 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:19:15.151 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=25 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:19:15.154 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:19:15.154 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:19:15.154 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:19:15.158 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=25 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:19:15.159 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=25 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:19:15.159 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=25 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:19:15.159 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:19:15.160 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:19:15.161 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:20:14.475 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:20:14.475 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:20:14.476 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND SETTINGS: ack=false settings=[id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064]
10:20:14.476 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND SETTINGS: ack=true
10:20:14.477 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND SETTINGS: ack=true
10:20:14.477 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:20:14.477 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:20:14.477 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND PING: ack=false bytes=1234
10:20:14.477 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:20:14.478 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND PING: ack=true bytes=1234
10:20:14.478 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND RST_STREAM: streamId=1 errorCode=0
10:20:14.478 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:20:14.479 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:20:14.479 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND PING: ack=false bytes=1234
10:20:14.479 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:20:14.480 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:20:14.481 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND PING: ack=true bytes=1234
10:20:14.481 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:20:14.481 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND PING: ack=false bytes=145258749040133895
10:20:14.481 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND PING: ack=true bytes=145258749040133895
10:20:14.482 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:20:14.482 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND DATA: streamId=5 padding=0 endStream=true length=2843 bytes=0000000b160a93163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:20:14.482 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND PING: ack=false bytes=1234
10:20:14.483 [pool-1-thread-5] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 2699
10:20:14.486 [pool-1-thread-5] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:20:14.490 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND PING: ack=true bytes=1234
10:20:14.512 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=27 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:20:14.512 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=27 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:20:14.512 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:20:14.513 [pool-1-thread-11] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:20:14.513 [pool-1-thread-11] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:20:14.518 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=27 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:20:14.519 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=27 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:20:14.519 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=27 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:20:14.521 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:20:14.521 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:20:14.522 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:20:14.522 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:20:14.528 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=27 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:20:14.528 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=27 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:20:14.528 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:20:14.529 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:20:14.530 [pool-1-thread-17] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:20:14.530 [pool-1-thread-17] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:20:14.532 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=27 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:20:14.532 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=27 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:20:14.532 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=27 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:20:14.536 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:20:14.536 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:20:14.536 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:20:16.719 [pool-1-thread-5] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=200, message=null
10:20:16.720 [pool-1-thread-5] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response body: Policy uploaded successfully with ID: 128d2f10-73b4-4267-a900-07b994660300
10:20:16.720 [pool-1-thread-5] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyId: 128d2f10-73b4-4267-a900-07b994660300
10:20:16.720 [pool-1-thread-5] INFO org.example.policy.service.PolicyServiceImpl - Policy uploaded successfully with ID: 128d2f10-73b4-4267-a900-07b994660300
10:20:16.720 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:20:16.721 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=83 bytes=000000004e0801124a506f6c6963792075706c6f61646564207375636365737366756c6c7920776974682049443a2031323864326631302d373362342d343236...
10:20:16.721 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:20:16.722 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=83
10:20:16.722 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND PING: ack=false bytes=145258749040133895
10:20:16.722 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND PING: ack=true bytes=145258749040133895
10:20:16.722 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:20:16.722 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND PING: ack=false bytes=1234
10:20:16.723 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] INBOUND PING: ack=true bytes=1234
10:20:16.723 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xd1cb13e3, L:/127.0.0.1:9090 - R:/127.0.0.1:42064] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:20:16.868 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=29 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:20:16.869 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=29 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:20:16.869 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:20:16.877 [pool-1-thread-13] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">128d2f10-73b4-4267-a900-07b994660300</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:20:16.879 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:20:16.884 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=29 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:20:16.884 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=29 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:20:16.884 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:20:16.885 [pool-1-thread-3] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">128d2f10-73b4-4267-a900-07b994660300</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:20:16.887 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:20:16.926 [pool-1-thread-13] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 128d2f10-73b4-4267-a900-07b994660300, responseCode: 200
10:20:16.927 [pool-1-thread-13] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"128d2f10-73b4-4267-a900-07b994660300","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:20:14.488998402Z","updatedAt":"2025-02-24T02:20:14.488998402Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:20:16.927 [pool-1-thread-13] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:20:16.932 [pool-1-thread-3] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 128d2f10-73b4-4267-a900-07b994660300, responseCode: 200
10:20:16.933 [pool-1-thread-3] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"128d2f10-73b4-4267-a900-07b994660300","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:20:14.488998402Z","updatedAt":"2025-02-24T02:20:14.488998402Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:20:16.934 [pool-1-thread-3] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:20:16.935 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=29 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:20:16.939 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=29 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:20:16.939 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=29 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:20:16.940 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:20:16.940 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:20:16.940 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:20:16.940 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=29 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:20:16.942 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=29 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:20:16.942 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=29 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:20:16.944 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:20:16.944 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:20:16.944 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:29:34.145 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:29:34.149 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:29:34.150 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND SETTINGS: ack=false settings=[id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758]
10:29:34.150 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND SETTINGS: ack=true
10:29:34.153 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND SETTINGS: ack=true
10:29:34.155 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:29:34.156 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:29:34.156 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND PING: ack=false bytes=1234
10:29:34.158 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:29:34.159 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND PING: ack=true bytes=1234
10:29:34.159 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND RST_STREAM: streamId=1 errorCode=0
10:29:34.159 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:29:34.163 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:29:34.163 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND PING: ack=false bytes=1234
10:29:34.164 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND PING: ack=true bytes=1234
10:29:34.165 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:29:34.166 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:29:34.168 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:29:34.169 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND PING: ack=false bytes=145258749040133895
10:29:34.170 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND PING: ack=true bytes=145258749040133895
10:29:34.173 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:29:34.174 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND DATA: streamId=5 padding=0 endStream=true length=2843 bytes=0000000b160a93163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:29:34.175 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND PING: ack=false bytes=1234
10:29:34.184 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND PING: ack=true bytes=1234
10:29:34.184 [pool-1-thread-10] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 2699
10:29:34.187 [pool-1-thread-10] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:29:34.296 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=31 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:29:34.297 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=31 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:29:34.297 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:29:34.297 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:29:34.298 [pool-1-thread-7] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:29:34.299 [pool-1-thread-7] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:29:34.300 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=31 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:29:34.306 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=31 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:29:34.306 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=31 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:29:34.311 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:29:34.311 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:29:34.312 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:29:34.338 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=31 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:29:34.338 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=31 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:29:34.338 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:29:34.340 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:29:34.342 [pool-1-thread-1] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:29:34.342 [pool-1-thread-1] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:29:34.344 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=31 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:29:34.345 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=31 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:29:34.345 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=31 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:29:34.346 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:29:34.346 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:29:34.346 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:29:36.612 [pool-1-thread-10] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=200, message=null
10:29:36.613 [pool-1-thread-10] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response body: Policy uploaded successfully with ID: 0dd89f89-0be8-40e6-b857-b667b9c8f51f
10:29:36.613 [pool-1-thread-10] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyId: 0dd89f89-0be8-40e6-b857-b667b9c8f51f
10:29:36.613 [pool-1-thread-10] INFO org.example.policy.service.PolicyServiceImpl - Policy uploaded successfully with ID: 0dd89f89-0be8-40e6-b857-b667b9c8f51f
10:29:36.614 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:29:36.614 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=83 bytes=000000004e0801124a506f6c6963792075706c6f61646564207375636365737366756c6c7920776974682049443a2030646438396638392d306265382d343065...
10:29:36.614 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:29:36.615 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=83
10:29:36.615 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND PING: ack=false bytes=145258749040133895
10:29:36.615 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND PING: ack=true bytes=145258749040133895
10:29:36.615 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:29:36.615 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND PING: ack=false bytes=1234
10:29:36.616 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:29:36.618 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xb092272d, L:/127.0.0.1:9090 - R:/127.0.0.1:33758] INBOUND PING: ack=true bytes=1234
10:29:36.763 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=33 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:29:36.770 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=33 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:29:36.770 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:29:36.775 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:29:36.775 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=33 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:29:36.776 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=33 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:29:36.776 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:29:36.777 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:29:36.777 [pool-1-thread-3] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">0dd89f89-0be8-40e6-b857-b667b9c8f51f</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:29:36.781 [pool-1-thread-4] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">0dd89f89-0be8-40e6-b857-b667b9c8f51f</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:29:36.885 [pool-1-thread-4] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 0dd89f89-0be8-40e6-b857-b667b9c8f51f, responseCode: 200
10:29:36.886 [pool-1-thread-4] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"0dd89f89-0be8-40e6-b857-b667b9c8f51f","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:29:34.273906667Z","updatedAt":"2025-02-24T02:29:34.273906667Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:29:36.887 [pool-1-thread-4] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:29:36.898 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=33 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:29:36.899 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=33 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:29:36.899 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=33 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:29:36.901 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:29:36.901 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:29:36.901 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:29:36.909 [pool-1-thread-3] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 0dd89f89-0be8-40e6-b857-b667b9c8f51f, responseCode: 200
10:29:36.910 [pool-1-thread-3] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"0dd89f89-0be8-40e6-b857-b667b9c8f51f","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:29:34.273906667Z","updatedAt":"2025-02-24T02:29:34.273906667Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:29:36.911 [pool-1-thread-3] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:29:36.917 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=33 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:29:36.918 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=33 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:29:36.918 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=33 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:29:36.921 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:29:36.921 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:29:36.921 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:32:52.599 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:32:52.599 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:32:52.600 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND SETTINGS: ack=false settings=[id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192]
10:32:52.600 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND SETTINGS: ack=true
10:32:52.600 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND SETTINGS: ack=true
10:32:52.600 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:32:52.600 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:32:52.600 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND PING: ack=false bytes=1234
10:32:52.603 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND PING: ack=true bytes=1234
10:32:52.603 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:32:52.604 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND RST_STREAM: streamId=1 errorCode=0
10:32:52.604 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:32:52.605 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:32:52.605 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND PING: ack=false bytes=1234
10:32:52.606 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND PING: ack=true bytes=1234
10:32:52.607 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:32:52.609 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:32:52.611 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:32:52.612 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND PING: ack=false bytes=145258749040133895
10:32:52.612 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND PING: ack=true bytes=145258749040133895
10:32:52.612 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:32:52.613 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND DATA: streamId=5 padding=0 endStream=true length=2843 bytes=0000000b160a93163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:32:52.613 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND PING: ack=false bytes=1234
10:32:52.613 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND PING: ack=true bytes=1234
10:32:52.614 [pool-1-thread-17] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 2699
10:32:52.615 [pool-1-thread-17] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:32:52.778 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=35 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:32:52.779 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=35 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:32:52.779 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:32:52.779 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:32:52.781 [pool-1-thread-5] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:32:52.781 [pool-1-thread-5] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:32:52.783 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=35 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:32:52.784 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=35 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:32:52.784 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=35 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:32:52.787 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:32:52.789 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:32:52.789 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:32:52.853 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=35 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:32:52.854 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=35 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:32:52.854 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:32:52.856 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:32:52.857 [pool-1-thread-19] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:32:52.857 [pool-1-thread-19] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:32:52.860 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=35 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:32:52.860 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=35 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:32:52.860 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=35 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:32:52.864 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:32:52.864 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:32:52.864 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:32:55.174 [pool-1-thread-17] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=200, message=null
10:32:55.174 [pool-1-thread-17] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response body: Policy uploaded successfully with ID: 3eb6da1f-33fa-4c9c-82af-f93a06c2607e
10:32:55.174 [pool-1-thread-17] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyId: 3eb6da1f-33fa-4c9c-82af-f93a06c2607e
10:32:55.174 [pool-1-thread-17] INFO org.example.policy.service.PolicyServiceImpl - Policy uploaded successfully with ID: 3eb6da1f-33fa-4c9c-82af-f93a06c2607e
10:32:55.175 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:32:55.175 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=83 bytes=000000004e0801124a506f6c6963792075706c6f61646564207375636365737366756c6c7920776974682049443a2033656236646131662d333366612d346339...
10:32:55.175 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:32:55.177 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=83
10:32:55.177 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND PING: ack=false bytes=145258749040133895
10:32:55.177 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND PING: ack=true bytes=145258749040133895
10:32:55.177 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:32:55.177 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND PING: ack=false bytes=1234
10:32:55.178 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] INBOUND PING: ack=true bytes=1234
10:32:55.178 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x5cb638fe, L:/127.0.0.1:9090 - R:/127.0.0.1:52192] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:32:55.265 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=37 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:32:55.265 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=37 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:32:55.265 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:32:55.266 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:32:55.266 [pool-1-thread-9] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">3eb6da1f-33fa-4c9c-82af-f93a06c2607e</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:32:55.277 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=37 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:32:55.278 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=37 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:32:55.278 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:32:55.279 [pool-1-thread-6] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">3eb6da1f-33fa-4c9c-82af-f93a06c2607e</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:32:55.286 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:32:55.343 [pool-1-thread-9] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 3eb6da1f-33fa-4c9c-82af-f93a06c2607e, responseCode: 200
10:32:55.343 [pool-1-thread-9] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"3eb6da1f-33fa-4c9c-82af-f93a06c2607e","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:32:52.760406502Z","updatedAt":"2025-02-24T02:32:52.760406502Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:32:55.344 [pool-1-thread-9] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:32:55.346 [pool-1-thread-6] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 3eb6da1f-33fa-4c9c-82af-f93a06c2607e, responseCode: 200
10:32:55.347 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=37 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:32:55.348 [pool-1-thread-6] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"3eb6da1f-33fa-4c9c-82af-f93a06c2607e","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:32:52.760406502Z","updatedAt":"2025-02-24T02:32:52.760406502Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:32:55.348 [pool-1-thread-6] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:32:55.350 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=37 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:32:55.350 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=37 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:32:55.352 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:32:55.352 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:32:55.352 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:32:55.358 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=37 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:32:55.358 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=37 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:32:55.358 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=37 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:32:55.361 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:32:55.361 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:32:55.361 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:49:20.591 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND SETTINGS: ack=false settings={MAX_CONCURRENT_STREAMS=2147483647, INITIAL_WINDOW_SIZE=1048576, MAX_HEADER_LIST_SIZE=8192}
10:49:20.592 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=983041
10:49:20.604 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND SETTINGS: ack=false settings=[id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462]
10:49:20.605 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND SETTINGS: ack=true
10:49:20.605 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND SETTINGS: ack=true
10:49:20.606 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND HEADERS: streamId=1 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:49:20.606 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND DATA: streamId=1 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:49:20.607 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND PING: ack=false bytes=1234
10:49:20.607 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND HEADERS: streamId=1 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-status: 12, grpc-message: Method not found: grpc.reflection.v1.ServerReflection/ServerReflectionInfo] padding=0 endStream=true
10:49:20.608 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND PING: ack=true bytes=1234
10:49:20.608 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND RST_STREAM: streamId=1 errorCode=0
10:49:20.608 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND HEADERS: streamId=3 headers=GrpcHttp2RequestHeaders[:path: /grpc.reflection.v1alpha.ServerReflection/ServerReflectionInfo, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:49:20.609 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND DATA: streamId=3 padding=0 endStream=false length=47 bytes=000000002a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c69637953657276696365
10:49:20.609 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND PING: ack=false bytes=1234
10:49:20.609 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND PING: ack=true bytes=1234
10:49:20.613 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:49:20.614 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND DATA: streamId=3 padding=0 endStream=false length=984 bytes=00000003d3122a22286f72672e6578616d706c652e706f6c6963792e736572766963652e506f6c6963795365727669636522a4070aa1070a0c706f6c6963792e...
10:49:20.616 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=984
10:49:20.616 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND PING: ack=false bytes=145258749040133895
10:49:20.616 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND PING: ack=true bytes=145258749040133895
10:49:20.617 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND HEADERS: streamId=5 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/uploadPolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpcurl/v1.9.2 grpc-go/1.61.0, grpc-accept-encoding: gzip] padding=0 endStream=false
10:49:20.619 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND DATA: streamId=5 padding=0 endStream=true length=2843 bytes=0000000b160a93163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:49:20.619 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND PING: ack=false bytes=1234
10:49:20.621 [pool-1-thread-14] INFO org.example.policy.service.PolicyServiceImpl - Received upload policy request, policy length: 2699
10:49:20.621 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND PING: ack=true bytes=1234
10:49:20.623 [pool-1-thread-14] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Uploading policy to Fabric-Client: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:49:20.771 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=39 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:49:20.771 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=39 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/validatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:49:20.771 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=39 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:49:20.772 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:49:20.773 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=39 padding=0 endStream=true length=2843 bytes=0000000b161293163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c506f6c69637920786d6c6e733d227572...
10:49:20.773 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:49:20.774 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:49:20.776 [pool-1-thread-17] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:49:20.776 [pool-1-thread-17] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:49:20.778 [pool-1-thread-2] INFO org.example.policy.service.PolicyServiceImpl - validatePolicy 请求 | 策略前50字符: <?xml version="1.0" encoding="UTF-8"?>
<Policy xml
10:49:20.778 [pool-1-thread-2] DEBUG org.example.policy.service.PolicyServiceImpl - 完整策略内容:
<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:49:20.782 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=39 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:49:20.782 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=39 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:49:20.782 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=39 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:49:20.784 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:49:20.784 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:49:20.784 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:49:20.786 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:49:20.786 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=39 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:49:20.787 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=39 padding=0 endStream=false length=24 bytes=000000001320012a0f506f6c6963792069732076616c6964
10:49:20.787 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=39 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:49:20.789 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=24
10:49:20.790 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:49:20.790 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:49:23.129 [pool-1-thread-14] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: code=200, message=null
10:49:23.133 [pool-1-thread-14] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response body: Policy uploaded successfully with ID: 6f2c9cb3-25fe-407c-99d5-a9cdf8a38625
10:49:23.133 [pool-1-thread-14] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyId: 6f2c9cb3-25fe-407c-99d5-a9cdf8a38625
10:49:23.133 [pool-1-thread-14] INFO org.example.policy.service.PolicyServiceImpl - Policy uploaded successfully with ID: 6f2c9cb3-25fe-407c-99d5-a9cdf8a38625
10:49:23.133 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:49:23.134 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND DATA: streamId=5 padding=0 endStream=false length=83 bytes=000000004e0801124a506f6c6963792075706c6f61646564207375636365737366756c6c7920776974682049443a2036663263396362332d323566652d343037...
10:49:23.134 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND HEADERS: streamId=5 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:49:23.135 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=83
10:49:23.135 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND PING: ack=false bytes=145258749040133895
10:49:23.135 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND PING: ack=true bytes=145258749040133895
10:49:23.135 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND DATA: streamId=3 padding=0 endStream=true length=0 bytes=
10:49:23.135 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND PING: ack=false bytes=1234
10:49:23.135 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] INBOUND PING: ack=true bytes=1234
10:49:23.135 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xdd37e1f8, L:/127.0.0.1:9090 - R:/127.0.0.1:47462] OUTBOUND HEADERS: streamId=3 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:49:23.232 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND HEADERS: streamId=41 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:49:23.232 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND DATA: streamId=41 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:49:23.232 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=false bytes=1234
10:49:23.233 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=true bytes=1234
10:49:23.235 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND HEADERS: streamId=41 headers=GrpcHttp2RequestHeaders[:path: /org.example.policy.service.PolicyService/evaluatePolicy, :authority: localhost:9090, :method: POST, :scheme: http, te: trailers, content-type: application/grpc, user-agent: grpc-go/1.53.0] padding=0 endStream=false
10:49:23.235 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND DATA: streamId=41 padding=0 endStream=true length=4440 bytes=00000011530aba0c3c5265717565737420786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f72653a736368656d61...
10:49:23.235 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=false bytes=1234
10:49:23.235 [pool-1-thread-6] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">6f2c9cb3-25fe-407c-99d5-a9cdf8a38625</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:49:23.237 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=true bytes=1234
10:49:23.239 [pool-1-thread-15] INFO org.example.policy.service.PolicyServiceImpl - Received evaluation request: <Request xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
         CombinedDecision="false"
         ReturnPolicyIdList="false">

    <!-- 用户属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
        </Attribute>
        <Attribute AttributeId="policyId" IncludeInResult="false">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">6f2c9cb3-25fe-407c-99d5-a9cdf8a38625</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 资源属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
        </Attribute>
    </Attributes>

    <!-- 操作属性 -->
    <Attributes Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action">
        <Attribute 
            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"
            IncludeInResult="false">  <!-- 添加此行 -->
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
        </Attribute>
    </Attributes>
</Request>

10:49:23.311 [pool-1-thread-6] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 6f2c9cb3-25fe-407c-99d5-a9cdf8a38625, responseCode: 200
10:49:23.311 [pool-1-thread-6] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"6f2c9cb3-25fe-407c-99d5-a9cdf8a38625","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:49:20.728794344Z","updatedAt":"2025-02-24T02:49:20.728794344Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:49:23.312 [pool-1-thread-6] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:49:23.315 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=41 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:49:23.315 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND DATA: streamId=41 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:49:23.315 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND HEADERS: streamId=41 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
10:49:23.316 [pool-1-thread-15] INFO org.example.policy.engine.DigitalTwinPolicyEngine - Fetching policy from Fabric-Client, policyId: 6f2c9cb3-25fe-407c-99d5-a9cdf8a38625, responseCode: 200
10:49:23.316 [pool-1-thread-15] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Fabric-Client response: {"code":0,"msg":"操作成功","data":{"id":"6f2c9cb3-25fe-407c-99d5-a9cdf8a38625","name":"UploadedPolicy","content":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Policy xmlns=\"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17\" \n        PolicyId=\"BasicAccessPolicy\" \n        RuleCombiningAlgId=\"urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides\" \n        Version=\"1.0\">\n\n    <!-- 策略目标：匹配请求中的资源、用户和操作 -->\n    <Target>\n        <AnyOf>\n            <AllOf>\n                <!-- 资源匹配 -->\n                <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                    <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">resource1</AttributeValue>\n                    <AttributeDesignator \n                        AttributeId=\"urn:oasis:names:tc:xacml:1.0:resource:resource-id\" \n                        Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:resource\" \n                        DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                        MustBePresent=\"true\"/>\n                </Match>\n            </AllOf>\n        </AnyOf>\n    </Target>\n\n    <!-- 规则1：允许 user1 的读取操作 -->\n    <Rule RuleId=\"permit-read-resource1\" Effect=\"Permit\">\n        <Target>\n            <AnyOf>\n                <AllOf>\n                    <!-- 用户匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">user1</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:subject:subject-id\" \n                            Category=\"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                    <!-- 操作匹配 -->\n                    <Match MatchId=\"urn:oasis:names:tc:xacml:1.0:function:string-equal\">\n                        <AttributeValue DataType=\"http://www.w3.org/2001/XMLSchema#string\">read</AttributeValue>\n                        <AttributeDesignator \n                            AttributeId=\"urn:oasis:names:tc:xacml:1.0:action:action-id\" \n                            Category=\"urn:oasis:names:tc:xacml:3.0:attribute-category:action\" \n                            DataType=\"http://www.w3.org/2001/XMLSchema#string\" \n                            MustBePresent=\"true\"/>\n                    </Match>\n                </AllOf>\n            </AnyOf>\n        </Target>\n        <Description>允许 user1 读取 resource1</Description>\n    </Rule>\n\n    <!-- 规则2：默认拒绝其他所有请求 -->\n    <Rule RuleId=\"deny-other-requests\" Effect=\"Deny\">\n        <Description>拒绝未明确允许的请求</Description>\n    </Rule>\n\n</Policy>\n","version":"1.0","status":"active","createdAt":"2025-02-24T02:49:20.728794344Z","updatedAt":"2025-02-24T02:49:20.728794344Z","createdBy":"eDUwOTo6Q049VXNlcjFAb3JnMS5leGFtcGxlLmNvbSxPVT1jbGllbnQsTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUzo6Q049Y2Eub3JnMS5leGFtcGxlLmNvbSxPPW9yZzEuZXhhbXBsZS5jb20sTD1TYW4gRnJhbmNpc2NvLFNUPUNhbGlmb3JuaWEsQz1VUw=="}}
10:49:23.319 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:49:23.324 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] INBOUND PING: ack=false bytes=145258749040133895
10:49:23.324 [grpc-default-worker-ELG-3-2] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0xf36e25e5, L:/127.0.0.1:9090 - R:/127.0.0.1:46446] OUTBOUND PING: ack=true bytes=145258749040133895
10:49:23.324 [pool-1-thread-15] DEBUG org.example.policy.engine.DigitalTwinPolicyEngine - Extracted policyContent: <?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" 
        PolicyId="BasicAccessPolicy" 
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides" 
        Version="1.0">

    <!-- 策略目标：匹配请求中的资源、用户和操作 -->
    <Target>
        <AnyOf>
            <AllOf>
                <!-- 资源匹配 -->
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">resource1</AttributeValue>
                    <AttributeDesignator 
                        AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" 
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" 
                        DataType="http://www.w3.org/2001/XMLSchema#string" 
                        MustBePresent="true"/>
                </Match>
            </AllOf>
        </AnyOf>
    </Target>

    <!-- 规则1：允许 user1 的读取操作 -->
    <Rule RuleId="permit-read-resource1" Effect="Permit">
        <Target>
            <AnyOf>
                <AllOf>
                    <!-- 用户匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">user1</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" 
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                    <!-- 操作匹配 -->
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator 
                            AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" 
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" 
                            DataType="http://www.w3.org/2001/XMLSchema#string" 
                            MustBePresent="true"/>
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Description>允许 user1 读取 resource1</Description>
    </Rule>

    <!-- 规则2：默认拒绝其他所有请求 -->
    <Rule RuleId="deny-other-requests" Effect="Deny">
        <Description>拒绝未明确允许的请求</Description>
    </Rule>

</Policy>

10:49:23.332 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=41 headers=GrpcHttp2OutboundHeaders[:status: 200, content-type: application/grpc, grpc-encoding: identity, grpc-accept-encoding: gzip] padding=0 endStream=false
10:49:23.334 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND DATA: streamId=41 padding=0 endStream=false length=213 bytes=00000000d00a065065726d697412c5013c526573706f6e736520786d6c6e733d2275726e3a6f617369733a6e616d65733a74633a7861636d6c3a332e303a636f...
10:49:23.334 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND WINDOW_UPDATE: streamId=0 windowSizeIncrement=213
10:49:23.334 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] INBOUND PING: ack=false bytes=145258749040133895
10:49:23.335 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND PING: ack=true bytes=145258749040133895
10:49:23.335 [grpc-default-worker-ELG-3-1] DEBUG io.grpc.netty.shaded.io.grpc.netty.NettyServerHandler - [id: 0x6afde87d, L:/127.0.0.1:9090 - R:/127.0.0.1:46454] OUTBOUND HEADERS: streamId=41 headers=GrpcHttp2OutboundHeaders[grpc-status: 0] padding=0 endStream=true
